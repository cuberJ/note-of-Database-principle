# 数据库安全性

## 授权机制

### 第一种划分机制

#### 数据库系统级

采用验证和授权机制使用户存取特定数据



#### 操作系统级

操作系统里的root用户可以对存放在系统里的数据库文件本身做拷贝和删除，需要防范



### 网络级

防止偷听和伪装



### 物理级

防止数据的物理损坏



### 人员级

审查用户确保口令不会泄露



## 安全方式

### 视图授权

```mysql
# 规定一个员工只能查看geology系的所有员工工资，看不到其他系的员工工资
# 禁止员工对数据库的直接访问，仅提供视图geo_instructor的访问
create view geo_instructor as(
select * 
from instructor
where dept_name = 'geology');
```



### 权限授予

1. 收回某个用户权限的时候，要记得收回更低级用户的权限。但如果某个更低级用户的权限是从多个用户处获取，则需要视情况收回
2. 循环授权可以存在，但其中一个用户被消除，其他的用户也都会被消除权限

```mysql
# 可以授予的权限包括：select, insert, update, delete, reference(允许在创建关系的时候建立外键), all privileges
# with grant option允许用户把授予的权限进行转授
# 角色role
create role instructor;
grant select on takes to instructor ;# 将在表takes中执行select的权利赋给角色instructor
create role dean; #再创建一个dean的角色
grant instructor to dean; # 将instructor角色的权利授予dean
```



### 权限收回

```mysql
revoke select on takes from instructor, dean cascade #从instructor和dean两个角色收回对takes的select权限，并采用级联（cascade）收回的方式
# 如果要防止级联删除，则将cascade换为restrict。采用restrict的指令在遇到级联的情况会执行失败
```

授权的局限性：

1. 不支持元组级授权：不能让学生只看到自己的分数
2. 某些应用的所有最终用户可能被映射为单个数据库用户



### 审计更新

跟踪应用程序对数据库的更改